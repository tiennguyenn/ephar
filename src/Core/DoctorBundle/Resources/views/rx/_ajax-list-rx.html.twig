{% set sortColumn = sortInfo is not empty ? sortInfo.column : '' %}
{% set sortDirection = sortInfo is not empty ? sortInfo.direction : '' %}

<div class="table-scrollable">
  <table class="table table-hover table-bordered dataTable" id="sample_1" role="grid" aria-describedby="sample_1_info">
    <thead>
      <tr role="row">
        <th class="sorting {% if 'rx.orderNumber' == sortColumn %}sorting_{{ sortDirection }}{% endif %}" tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="0" aria-sort="ascending" aria-label=" Order ID : activate to sort column descending" data-sort="rx.orderNumber">Order ID</th>
        <th class="sorting {% if 'rx.createdOn' == sortColumn %}sorting_{{ sortDirection }}{% endif %}" tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="1" aria-label=" RX Issue Date : activate to sort column ascending" data-sort="rx.createdOn"> RX Issue Date </th>
        <th class="sorting {% if 'p.patientCode' == sortColumn %}sorting_{{ sortDirection }}{% endif %}" tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="2" aria-label=" Payment Code : activate to sort column ascending" data-sort="p.patientCode"> Patient Code </th>
        <th class="sorting {% if 'info.firstName' == sortColumn %}sorting_{{ sortDirection }}{% endif %}" tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="3" aria-label=" Payment Name : activate to sort column ascending" data-sort="info.firstName"> Patient Name </th>
        {% if isFailed %}
        <th class="sorting {% if 'failedOn' == sortColumn %}sorting_{{ sortDirection }}{% endif %}" tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="4" aria-label=" Failure Timestamp : activate to sort column ascending" data-sort="failedOn"> Failure Timestamp </th>
        {% elseif isRecalled %}
        <th class="sorting {% if 'rx.updatedOn' == sortColumn %}sorting_{{ sortDirection }}{% endif %}" tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="4" aria-label=" Recalled Timestamp : activate to sort column ascending" data-sort="rx.updatedOn"> Recalled Timestamp </th>
        {% elseif isDraft or isPending %}
        {% else %}
        <th class="sorting {% if 'rx.status' == sortColumn %}sorting_{{ sortDirection }}{% endif %}" tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="4" aria-label=" Status : activate to sort column ascending" data-sort="rx.status"> Status </th>
        {% endif %}
        <th tabindex="0" aria-controls="sample_1" rowspan="1" colspan="1" data-column-index="4" aria-label=" Actions : activate to sort column ascending"> Actions </th>
      </tr>
    </thead>
    <tbody>
    {% for item in data %}
      <tr role="row" class="{{ loop.index%2 ? 'odd' : 'even' }} {% if item.isDoctorRead is not null and item.isDoctorRead == 0 %} highlight {%  endif %}">
        <td> {{ item[0].orderNumber  }}</td>
        <td>{{ item[0].createdOn ? item[0].createdOn|date('d M y') : '' }}</td>
        <td>{{ item[0].patient.patientCode }}</td>
        <td>{{ item.firstName ~ ' ' ~ item.lastName }}</td>
        {% if isFailed %}
        <td>{{ item.failedOn|date('d M y') }}</td>
        {% elseif isRecalled %}
        <td>{{ item[0].updatedOn|date('d M y') }}</td>
        {% elseif isDraft or isPending %}
        {% else %}
        {% if item[0].status in arrGreen %}
        {% set statusColor = 'green' %}
        {% elseif item[0].status in arrGray %}
        {% set statusColor = 'default' %}
        {% elseif item[0].status in arrBlue %}
        {% set statusColor = 'blue' %}
        {% elseif item[0].status in arrYellow %}
        {% set statusColor = 'yellow' %}
        {% else %}
        {% set statusColor = 'danger' %}
        {% endif %}
        <td class="status {{ item[0].deletedOn != null ? 'danger' : statusColor }}">{{ item[0].deletedOn != null ? 'Deleted' : convertRXStatus(item[0].status) }}</td>
        {% endif %}
        {% if isDraft %}
        <td><a href="{{ path('edit_rx', {'rxId': item[0].id}) }}" class="btn btn-ahalf-circle text-uppercase green-seagreen btn-xs btn-icon-right">Edit <i class="fa fa-edit"></i></a> <a href="#modal-delete" class="btn btn-ahalf-circle text-uppercase red btn-outline btn-xs btn-icon-right deleteBtn" data-url="{{ path('delete_rx', {'rxId':item[0].id}) }}" data-ordernumber="{{ item[0].orderNumber }}" data-toggle="modal" data-target="#modal-delete">Delete <i class="fa fa-trash"></i></a></td>
        {% else %}
        <td>
        {% if isPending %}
        <a href="javascript:;" class="btn btn-ahalf-circle text-uppercase red btn-xs btn-icon-right recallBtn" data-url="{{ path('ajax_recall', {'rxId': item[0].id}) }}">Recall <i class="fa fa-rotate-left"></i></a>
        {% endif %}
        {% if isFailed and constant('UtilBundle\\Utility\\Constant::RX_STATUS_PAYMENT_FAILED') == item[0].status %}
        <a href="javascript:;" class="btn btn-ahalf-circle text-uppercase green-seagreen btn-xs btn-icon-right resendBtn" data-url="{{ path('ajax_resend', {'id': item[0].id}) }}">Resend <i class="fa fa-send"></i></a>
        {% endif %}
        {% if isRecalled and constant('UtilBundle\\Utility\\Constant::RX_STATUS_PENDING') == item[0].status %}
        <a href="{{ path('edit_rx', {'rxId': item[0].id}) }}" class="btn btn-ahalf-circle text-uppercase green-seagreen btn-xs btn-icon-right" >Edit <i class="fa fa-send"></i></a>
        {% endif %}
        <a href="{{ path(constant('UtilBundle\\Utility\\Constant::RX_STATUS_DRAFT') == item[0].status or constant('UtilBundle\\Utility\\Constant::RX_STATUS_FOR_DOCTOR_REVIEW') == item[0].status or constant('UtilBundle\\Utility\\Constant::RX_STATUS_FOR_AMENDMENT') == item[0].status ? 'edit_rx' : 'view_rx', {'rxId': item[0].id}) }}" class="btn btn-ahalf-circle text-uppercase green-seagreen btn-xs btn-icon-right">View <i class="fa fa-arrow-right"></i></a>
        <a href="javascript:;" class="btn btn-ahalf-circle text-uppercase green-seagreen btn-outline btn-xs btn-icon-right activitieLink" data-url="{{ path('ajax_get_activities_log', {'rxId':item[0].id}) }}" data-ordernumber="{{ item[0].orderNumber }}" data-print="{{ path('doctor_rx_activities_print_logs', {'rxId':item[0].id}) }}">Activities Log</a>
        </td>
        {% endif %}
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>

{% if data|length > 0 %}
    {% set fromRecord = currentPage > 0? currentPage*perPage: currentPage %}
    {% set toRecored = fromRecord + perPage %}
    <div class="row">
        <div class="col-md-5 col-sm-12">
            <div class="dataTables_info" role="status" aria-live="polite">Showing {{ fromRecord + 1 }} to {{ toRecored < totalResult? toRecored: totalResult }} of {{ totalResult }} entries</div>
        </div>
        <div class="col-md-7 col-sm-12">
            <div class="dataTables_paginate paging_bootstrap_number ajax_paging">
                {{ paginationHTML|raw }}
            </div>
        </div>
    </div>
    <input type="hidden" name="page" value="{{ currentPage }}">
{% endif %}